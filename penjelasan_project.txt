================================================================================
DOKUMENTASI PROYEK & BEDAH KODE (PBO Project)
================================================================================

Nama Proyek: Music Streaming App (Tubes PBO)
Framework: Spring Boot (Java)
Architecture: MVC (Model-View-Controller)

Berikut adalah penjelasan detail mengenai fitur-fitur dalam aplikasi dan lokasi kodenya (File Mapping).

--------------------------------------------------------------------------------
1. STRUKTUR UTAMA
--------------------------------------------------------------------------------
Aplikasi ini dibangun menggunakan arsitektur MVC.
- Controller: Menerima request dari browser (URL), memanggil Service, dan memilih View (JSP).
  Lokasi: `src/main/java/com/example/tubes/controller/`
- Service: Logika bisnis utama (misal: validasi, perhitungan, pemrosesan data).
  Lokasi: `src/main/java/com/example/tubes/service/`
- Entity (Model): Representasi tabel database.
  Lokasi: `src/main/java/com/example/tubes/entity/`
- View: Halaman antarmuka pengguna (HTML/JSP).
  Lokasi: `src/main/webapp/WEB-INF/jsp/`

--------------------------------------------------------------------------------
2. FITUR & LOKASI KODE
--------------------------------------------------------------------------------

A. OTENTIKASI (LOGIN & REGISTER)
   Fitur untuk mendaftar akun baru, login, dan logout.

   - File Utama:
     - `AuthController.java`: Mengatur route `/login`, `/register`, dan `/logout`.
     - `UserService.java`: Logika pengecekan password dan penyimpanan user baru.
     - `User.java`: Entity database untuk tabel `users`.
   - View (Tampilan):
     - `auth/login.jsp`: Halaman form login.
     - (Register biasanya digabung atau ada modal di login page/view terpisah).

   Detail Kode (`AuthController.java`):
   - `@PostMapping("/login")`: Menerima input email/pass, cek ke DB via UserService. Jika sukses simpan user ke `HttpSession`.
   - `@PostMapping("/register")`: Menerima data User baru, panggil `userService.register()`.

B. MANAJEMEN LAGU (SONGS)
   Fitur menampilkan daftar lagu, mencari, dan memutar lagu (increment plays).

   - File Utama:
     - `SongController.java`: Mengatur route `/songs` (list) dan `/songs/{id}` (detail).
     - `ISongService.java` & `SongServiceImpl.java`: Service untuk mencari lagu dari DB.
     - `Song.java`: Entity database tabel `songs` (menyimpan judul, artis, file path, cover).
     - `ApiController.java` (Khusus AJAX): Digunakan untuk fungsi interaktif tanpa reload, seperti fetch random song (`/api/songs/random`).
   - View (Tampilan):
     - `songs/index.jsp`: Daftar semua lagu & hasil search.
     - `songs/show.jsp`: Halaman detail lagu + Player + Komentar.

   Detail Kode (`SongController.java`):
   - `index()`: Menarik semua lagu via `songService.getAllSongs()`. Mengirim ke `songs/index.jsp`.
   - `show()`: Menampilkan detail 1 lagu, memuat komentar (`commentService`), dan status Like user.

C. INTERAKSI (LIKE & KOMENTAR)
   Fitur sosial di mana user bisa menyukai lagu dan memberi komentar.

   - File Utama:
     - `ApiController.java`: Menangani Like secara asinkron (`/api/songs/{id}/like`). Jadi halaman tidak perlu reload saat klik Like.
     - `SongController.java`: Menangani submit komentar (`/songs/{id}/comments`) dan delete komentar.
     - `CommentService.java`: Logika CRUD komentar.
     - `UserService.java`: Logika `toggleLike` (menambah/menghapus like dari user).
   - Entity:
     - `Comment.java`: Tabel komentar, berelasi dengan `User` dan `Song`.
     - `User.java`: Memiliki relasi `@ManyToMany` ke `Song` untuk fitur Likes (`likedSongs`).

D. PLAYLIST
   Fitur user membuat playlist pribadi dan menambahkan lagu ke dalamnya.

   - File Utama:
     - `PlaylistController.java`: CRUD Playlist (Create, Read, Update, Delete).
     - `PlaylistService.java`: Logika bisnis playlist.
     - `Playlist.java`: Entity playlist.
   - View:
     - `playlists/index.jsp`: Daftar playlist user.
     - `playlists/show.jsp`: Detail isi playlist.

E. HISTORY & REPORTING
   Mencatat lagu yang didengar dan menampilkan riwayat/laporan.

   - File Utama:
     - `HistoryController.java`: Menampilkan halaman riwayat (`/history`).
     - `ApiController.java`: Endpoint `/api/history/record` dipanggil via JavaScript saat lagu diputar > 10 detik (atau selesai) untuk mencatat history.
     - `History.java`: Entity pencatatan waktu putar.
     - `ReportController.java`: Mungkin untuk fitur admin atau rekap statistik.
   - View:
     - `history/index.jsp`: Halaman riwayat putar.
     - `report/index.jsp`: Halaman laporan.

F. USER vs PENGGUNA (Inheritance)
   Ada struktur pewarisan (Inheritance) pada user.
   - `User.java`: Parent class (umum), menyimpan email, username, password.
   - `Pengguna.java`: Child class, mungkin dirancang untuk method spesifik user biasa (seperti `klikLagu`, `beriLike`).
   - `Admin.java`: Child class untuk role admin.

--------------------------------------------------------------------------------
3. ALUR KERJA (FLOW) CONTOH
--------------------------------------------------------------------------------

Scenario: User Memutar Lagu
1. User membuka halaman lagu (`SongController.show`).
2. JSP (`songs/show.jsp`) merender player audio.
3. Saat user klik Play, script JS memanggil API `/api/history/record` (di `ApiController`).
4. `ApiController` memanggil `HistoryService` untuk simpan record baru ke DB dan `SongService` untuk `incrementPlays` (tambah jumlah putar).

Scenario: User Like Lagu
1. User klik tombol Like di halaman detail.
2. JS mengirim POST ke `/api/songs/{id}/like` (`ApiController`).
3. `UserService.toggleLike` dipanggil: Cek kalau sudah like -> hapus, kalau belum -> tambah.
4. Response JSON dikirim balik ke browser untuk update warna tombol Like (Merah/Putih).

--------------------------------------------------------------------------------
4. KONFIGURASI PENTING LAINNYA
--------------------------------------------------------------------------------
- `DataSeeder.java`: (Biasanya di folder `config`) Code yang jalan saat aplikasi pertama kali start. Berguna untuk mengisi data awal (Admin user, Sample Songs) agar database tidak kosong.
- `GlobalExceptionHandler.java`: Menangani error secara global agar user mendapat halaman error yang rapi, bukan stacktrace jelek.

--------------------------------------------------------------------------------
Dibuat otomatis oleh AI Assistant untuk referensi pengembangan.
================================================================================
